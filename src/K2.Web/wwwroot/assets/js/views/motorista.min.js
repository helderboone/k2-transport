var Motorista=function(){var t=function(){App.bloquear();$("#tblMotorista").DataTable({ajax:{url:App.corrigirPathRota("listar-motoristas"),type:"POST",error:function(n){var t=Feedback.converter(n.responseJSON);t.exibirModal()},data:function(n){n.Nome=$("#iProcurarNome").val();n.Email=$("#iProcurarEmail").val();n.Cpf=$("#iProcurarCpf").val();n.Rg=$("#iProcurarRg").val();n.Cnh=$("#iProcurarCnh").val()}},info:!0,columns:[{data:"nome",title:"Nome",orderable:!0,className:"all"},{data:"celularFormatado",title:"Celular",orderable:!1},{data:"email",title:"E-mail",orderable:!0},{data:"cpfFormatado",title:"CPF",orderable:!1},{data:"rg",title:"RG",orderable:!1},{data:"cnh",title:"CNH",orderable:!1},{data:"ativo",title:"Ativo",className:"dt-center",orderable:!1,width:"30px",render:function(n,t,i){return i.ativo?'<span class="m-badge m-badge--success"><\/span>':'<span class="m-badge m-badge--danger"><\/span>'}},{data:null,className:"td-actions dt-center",orderable:!1,width:"70px",render:function(n,t,i){return'<a href="#" data-id-usuario="'+i.idUsuario+'" class="redefinir-senha m-portlet__nav-link btn m-btn m-btn--hover-brand m-btn--icon m-btn--icon-only m-btn--pill" data-container="body" data-toggle="m-tooltip" data-placement="left" title="" data-original-title="Redefinir senha"><i class="fa fa-unlock"><\/i><\/a><a href="#" data-id="'+i.id+'" class="alterar-motorista m-portlet__nav-link btn m-btn m-btn--hover-brand m-btn--icon m-btn--icon-only m-btn--pill" data-container="body" data-toggle="m-tooltip" data-placement="left" title="" data-original-title="Alterar"><i class="la la-edit"><\/i><\/a><a href="#" data-id="'+i.id+'" class="excluir-motorista m-portlet__nav-link btn m-btn m-btn--hover-danger m-btn--icon m-btn--icon-only m-btn--pill" data-container="body" data-toggle="m-tooltip" data-placement="left" title="" data-original-title="Excluir"><i class="la la-trash"><\/i><\/a>'}}],select:{style:"single",info:!1},serverSide:!0,responsive:!0,pagingType:"full_numbers",order:[0,"asc"],searching:!1,paging:!0,lengthChange:!1,pageLength:25}).on("draw.dt",function(){mApp.initTooltips();$("a[class*='redefinir-senha']").each(function(){var n=$(this).data("id-usuario");$(this).click(function(){K2.redefinirSenha(n)})});$("a[class*='alterar-motorista']").each(function(){var t=$(this).data("id");$(this).click(function(){n(t)})});$("a[class*='excluir-motorista']").each(function(){var n=$(this).data("id");$(this).click(function(){App.exibirConfirm("Deseja realmente excluir esse motorista?","Sim","NÃ£o",function(){r(n)})})})}).on("processing.dt",function(){App.bloquear()})},i=function(){$("#frmProcurarMotorista").validate({submitHandler:function(){$("#tblMotorista").DataTable().ajax.reload()}})},n=function(n){var t=n===null||n===0;App.exibirModalPorRota(t?App.corrigirPathRota("cadastrar-motorista"):App.corrigirPathRota("alterar-motorista/"+n),function(){$("#iCpf, #iProcurarCpf").inputmask({mask:"999.999.999-99",clearIncomplete:!0});$("#iCelular").inputmask({mask:"(99) 99999-9999",clearIncomplete:!0});$("#iCep").inputmask({mask:"99.999-999",clearIncomplete:!0});$("#iDataExpedicaoCnh").inputmask("dd/mm/yyyy",{placeholder:"_",clearIncomplete:!0});$("#iDataValidadeCnh").inputmask("dd/mm/yyyy",{placeholder:"_",clearIncomplete:!0});$("#sEstado").select2({placeholder:"Selecione um estado"});$("#frmManterMotorista").validate({rules:{iNome:{required:!0},iEmail:{required:!0,email:!0},iCpf:{required:!0},iRg:{required:!0},iCelular:{required:!0},iCnh:{required:!0},iDataExpedicaoCnh:{required:!0},iDataValidadeCnh:{required:!0}},submitHandler:function(){var n={Id:$("#iIdMotorista").val(),Nome:$("#iNome").val(),Email:$("#iEmail").val(),Cpf:$("#iCpf").val(),Rg:$("#iRg").val(),Celular:$("#iCelular").val(),Ativo:$("#cAtivo").is(":checked"),Cnh:$("#iCnh").val(),DataValidadeCnh:$("#iDataValidadeCnh").val(),DataExpedicaoCnh:$("#iDataExpedicaoCnh").val(),Cep:$("#iCep").val(),Endereco:$("#iEndereco").val(),Municipio:$("#iMunicipio").val(),Uf:$("#sEstado").val()};App.bloquear();$.post(App.corrigirPathRota(t?"cadastrar-motorista":"alterar-motorista"),{entrada:n}).done(function(n){var t=Feedback.converter(n);t.Tipo.Nome==Tipo.Sucesso?t.exibirModal(function(){$("#tblMotorista").DataTable().ajax.reload();App.ocultarModal()}):t.exibirModal()}).fail(function(n){var t=Feedback.converter(n.responseJSON);t.exibirModal()}).always(function(){App.desbloquear()})}})})},r=function(n){App.bloquear();$.post(App.corrigirPathRota("excluir-motorista/"+n),function(n){var t=Feedback.converter(n);t.Tipo.Nome==Tipo.Sucesso?t.exibirModal(function(){$("#tblMotorista").DataTable().ajax.reload();App.ocultarModal()}):t.exibirModal()}).fail(function(n){var t=Feedback.converter(n.responseJSON);t.exibirModal()})};return{init:function(){t();$("#bCadastrar").click(function(){n(null)});$("#bProcurar").click(function(){i()})}}}();jQuery(document).ready(function(){Motorista.init()});