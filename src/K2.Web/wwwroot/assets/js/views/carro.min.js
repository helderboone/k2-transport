var Carro=function(){var t=function(){App.bloquear();$("#tblCarro").DataTable({ajax:{url:App.corrigirPathRota("listar-carros"),type:"POST",error:function(n){var t=Feedback.converter(n.responseJSON);t.exibirModal()},data:function(n){n.Descricao=$("#iProcurarDescricao").val();n.NomeFabricante=$("#iProcurarNomeFabricante").val();n.AnoModelo=$("#iProcurarAnoModelo").val();n.Placa=$("#iProcurarPlaca").val();n.Renavam=$("#iProcurarRenavam").val()}},info:!0,columns:[{data:"descricao",title:"Descrição",orderable:!0,className:"all"},{data:null,title:"Proprietário",orderable:!1,render:function(n,t,i){return i.proprietario.nome}},{data:"nomeFabricante",title:"Fabricante",orderable:!0},{data:"anoModelo",title:"Ano / modelo",orderable:!0},{data:"quantidadeLugares",title:"Qtd. passageiros",orderable:!0},{data:"placa",title:"Placa",orderable:!0},{data:"renavam",title:"Renavam",orderable:!1},{data:null,className:"td-actions dt-center",orderable:!1,width:"70px",render:function(n,t,i){return'<a href="#" data-id="'+i.id+'" class="alterar-carro m-portlet__nav-link btn m-btn m-btn--hover-brand m-btn--icon m-btn--icon-only m-btn--pill" data-container="body" data-toggle="m-tooltip" data-placement="left" title="" data-original-title="Alterar"><i class="la la-edit"><\/i><\/a><a href="#" data-id="'+i.id+'" class="excluir-carro m-portlet__nav-link btn m-btn m-btn--hover-danger m-btn--icon m-btn--icon-only m-btn--pill" data-container="body" data-toggle="m-tooltip" data-placement="left" title="" data-original-title="Excluir"><i class="la la-trash"><\/i><\/a>'}}],select:{style:"single",info:!1},serverSide:!0,responsive:!0,pagingType:"full_numbers",order:[0,"asc"],searching:!1,paging:!0,lengthChange:!1,pageLength:25}).on("draw.dt",function(){mApp.initTooltips();$("a[class*='alterar-carro']").each(function(){var t=$(this).data("id");$(this).click(function(){n(t)})});$("a[class*='excluir-carro']").each(function(){var n=$(this).data("id");$(this).click(function(){App.exibirConfirm("Deseja realmente excluir esse carro?","Sim","Não",function(){r(n)})})})}).on("processing.dt",function(){App.bloquear()})},i=function(){$("#frmProcurarCarro").validate({submitHandler:function(){$("#tblCarro").DataTable().ajax.reload()}})},n=function(n){var t=n===null||n===0;App.exibirModalPorRota(t?App.corrigirPathRota("cadastrar-carro"):App.corrigirPathRota("alterar-carro/"+n),function(){$("#sProprietario").select2({placeholder:"Selecione um proprietário",dropdownParent:$(".jc-bs3-container")});$("#sCaracteristicas").select2({placeholder:"Selecione as características",dropdownParent:$(".jc-bs3-container")});$("#iQuantidadeLugares").inputmask({mask:"9",repeat:2,greedy:!1});$("#iPlaca").inputmask({mask:"aaa-9999"});$("#iAnoModelo").inputmask({mask:"9999/99"});$("#iRenavam").inputmask({mask:"99999999999"});$("#frmManterCarro").validate({rules:{iNome:{required:!0},sEstado:{required:!0}},submitHandler:function(){var n={Id:$("#iIdCarro").val(),Nome:$("#iNome").val(),Uf:$("#sEstado").val()};App.bloquear($("#frmManterCarro"));$.post(App.corrigirPathRota(t?"cadastrar-carro":"alterar-carro"),{entrada:n}).done(function(n){var t=Feedback.converter(n);t.Tipo.Nome==Tipo.Sucesso?t.exibirModal(function(){$("#tblCarro").DataTable().ajax.reload();App.ocultarModal()}):t.exibirModal()}).fail(function(n){var t=Feedback.converter(n.responseJSON);t.exibirModal()}).always(function(){App.desbloquear($("#frmManterCarro"))})}})})},r=function(n){App.bloquear();$.post(App.corrigirPathRota("excluir-carro/"+n),function(n){var t=Feedback.converter(n);t.Tipo.Nome==Tipo.Sucesso?t.exibirModal(function(){$("#tblCarro").DataTable().ajax.reload();App.ocultarModal()}):t.exibirModal()}).fail(function(n){var t=Feedback.converter(n.responseJSON);t.exibirModal()})};return{init:function(){t();$("#iProcurarPlaca").inputmask({mask:"aaa-9999"});$("#bCadastrar").click(function(){n(null)});$("#bProcurar").click(function(){i()})}}}();jQuery(document).ready(function(){Carro.init()});